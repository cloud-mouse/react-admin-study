import{k as ne,c as te,g as ae,b as re}from"./@babel-CbNk-B6_.js";import{T as ie}from"./@rc-component-DYklQSrI.js";import{c as S}from"./classnames-ELZfJkp_.js";import{t as oe,K as L,f as W,i as D,s as _}from"./rc-util-jI2IUycA.js";import{r as b,a as t}from"./react-CIM1rrag.js";var le=L.ESC,se=L.TAB;function fe(e){var u=e.visible,r=e.triggerRef,s=e.onVisibleChange,c=e.autoFocus,i=e.overlayRef,a=b.useRef(!1),f=function(){if(u){var n,o;(n=r.current)===null||n===void 0||(o=n.focus)===null||o===void 0||o.call(n),s==null||s(!1)}},p=function(){var n;return(n=i.current)!==null&&n!==void 0&&n.focus?(i.current.focus(),a.current=!0,!0):!1},h=function(n){switch(n.keyCode){case le:f();break;case se:{var o=!1;a.current||(o=p()),o?n.preventDefault():f();break}}};b.useEffect(function(){return u?(window.addEventListener("keydown",h),c&&oe(p,3),function(){window.removeEventListener("keydown",h),a.current=!1}):function(){a.current=!1}},[u])}var ue=b.forwardRef(function(e,u){var r=e.overlay,s=e.arrow,c=e.prefixCls,i=b.useMemo(function(){var f;return typeof r=="function"?f=r():f=r,f},[r]),a=W(u,D(i));return t.createElement(t.Fragment,null,s&&t.createElement("div",{className:"".concat(c,"-arrow")}),t.cloneElement(i,{ref:_(i)?a:void 0}))}),d={adjustX:1,adjustY:1},v=[0,0],ce={topLeft:{points:["bl","tl"],overflow:d,offset:[0,-4],targetOffset:v},top:{points:["bc","tc"],overflow:d,offset:[0,-4],targetOffset:v},topRight:{points:["br","tr"],overflow:d,offset:[0,-4],targetOffset:v},bottomLeft:{points:["tl","bl"],overflow:d,offset:[0,4],targetOffset:v},bottom:{points:["tc","bc"],overflow:d,offset:[0,4],targetOffset:v},bottomRight:{points:["tr","br"],overflow:d,offset:[0,4],targetOffset:v}},de=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function ve(e,u){var r,s=e.arrow,c=s===void 0?!1:s,i=e.prefixCls,a=i===void 0?"rc-dropdown":i,f=e.transitionName,p=e.animation,h=e.align,m=e.placement,n=m===void 0?"bottomLeft":m,o=e.placements,j=o===void 0?ce:o,K=e.getPopupContainer,$=e.showAction,B=e.hideAction,H=e.overlayClassName,I=e.overlayStyle,X=e.visible,N=e.trigger,A=N===void 0?["hover"]:N,Y=e.autoFocus,M=e.overlay,y=e.children,w=e.onVisibleChange,q=ne(e,de),z=t.useState(),E=te(z,2),G=E[0],x=E[1],R="visible"in e?X:G,P=t.useRef(null),k=t.useRef(null),T=t.useRef(null);t.useImperativeHandle(u,function(){return P.current});var V=function(l){x(l),w==null||w(l)};fe({visible:R,triggerRef:T,onVisibleChange:V,autoFocus:Y,overlayRef:k});var J=function(l){var C=e.onOverlayClick;x(!1),C&&C(l)},F=function(){return t.createElement(ue,{ref:k,overlay:M,prefixCls:a,arrow:c})},Q=function(){return typeof M=="function"?F:F()},U=function(){var l=e.minOverlayWidthMatchTrigger,C=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?l:!C},Z=function(){var l=e.openClassName;return l!==void 0?l:"".concat(a,"-open")},ee=t.cloneElement(y,{className:S((r=y.props)===null||r===void 0?void 0:r.className,R&&Z()),ref:_(y)?W(T,D(y)):void 0}),O=B;return!O&&A.indexOf("contextMenu")!==-1&&(O=["click"]),t.createElement(ie,ae({builtinPlacements:j},q,{prefixCls:a,ref:P,popupClassName:S(H,re({},"".concat(a,"-show-arrow"),c)),popupStyle:I,action:A,showAction:$,hideAction:O,popupPlacement:n,popupAlign:h,popupTransitionName:f,popupAnimation:p,popupVisible:R,stretch:U()?"minWidth":"",popup:Q(),onPopupVisibleChange:V,onPopupClick:J,getPopupContainer:K}),ee)}const Ce=t.forwardRef(ve);export{Ce as D};
