import{r as h,j as e,a as g}from"./react-CIM1rrag.js";import{b as F}from"./react-dom-CJeuIbjI.js";import{u as A,a as C,P as E}from"./react-redux-D0yBdTpB.js";import{c as O,a as P}from"./@reduxjs-CqQfAypW.js";import{L as S,M as T,B as d,D as M,S as $,A as k,s as f,F as B,a as m,I as x}from"./antd-CUObeLNM.js";import{u as H,a as v,L,H as q,R as z,b as I,N as K}from"./react-router-CLRxoatf.js";import{N as U,O as b,P as J,Q,T as _,U as G}from"./@ant-design-BC-b2WZW.js";import{u as V}from"./react-hook-form-BGZJ-NlQ.js";import"./classnames-ELZfJkp_.js";import"./scheduler-vn6Di64w.js";import"./use-sync-external-store-BrmDI3wq.js";import"./redux-DHIXsp5o.js";import"./immer-DFAsTp4z.js";import"./redux-thunk-ClJT1hhx.js";import"./rc-util-jI2IUycA.js";import"./@babel-CbNk-B6_.js";import"./react-is-BpBQ4hf7.js";import"./rc-resize-observer-DzFB8mcR.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-C8hKN_nz.js";import"./@rc-component-DYklQSrI.js";import"./rc-tooltip-CSlTsdNr.js";import"./rc-overflow-CGdw2xB4.js";import"./rc-menu-sZHWDNAJ.js";import"./rc-select-BE_RAQt-.js";import"./rc-virtual-list-jPw5Q6vC.js";import"./rc-field-form-C4uicx5k.js";import"./scroll-into-view-if-needed-m3rLrdt6.js";import"./compute-scroll-into-view-r6mj3pQe.js";import"./rc-notification-HMioD8NS.js";import"./rc-table-CkLUP5U0.js";import"./rc-tree-D3G6_c9r.js";import"./rc-checkbox-_OApH_jJ.js";import"./rc-pagination-DV1iuG3E.js";import"./rc-picker-CBunl1Vo.js";import"./rc-dropdown-ClCqGEXP.js";import"./throttle-debounce-B7n2cUDB.js";import"./rc-input-RdaaKTYE.js";import"./rc-textarea-BqLitt1-.js";import"./cookie--_YQFYBD.js";import"./@emotion-CW87jbl0.js";import"./stylis-CnpK-kws.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const W={token:localStorage.getItem("token"),userInfo:JSON.parse(localStorage.getItem("userInfo")||"null"),isLoggedIn:!!localStorage.getItem("token")},w=O({name:"user",initialState:W,reducers:{setToken:(t,n)=>{t.token=n.payload,t.isLoggedIn=!0,localStorage.setItem("token",n.payload)},setUserInfo:(t,n)=>{t.userInfo=n.payload},logout:t=>{t.token=null,t.userInfo=null,t.isLoggedIn=!1,localStorage.removeItem("token")}}}),{setToken:X,setUserInfo:Y,logout:Z}=w.actions,ee=w.reducer,te=P({reducer:{user:ee}}),D=A,N=C,se=""+new URL("../png/avator-DQl2h3Bt.png",import.meta.url).href,{Header:oe,Sider:re,Content:ne}=S,ie=({children:t})=>{const n=D(),{userInfo:o,isLoggedIn:i}=N(l=>l.user),r=H(),s=v(),a=r.pathname;console.log(a);const[c,p]=h.useState(!1),j=()=>{localStorage.removeItem("token"),localStorage.removeItem("userInfo"),f.success("退出登录成功"),n(Z()),s("/login")},y={items:[{key:"logout",icon:e.jsx(_,{}),label:"退出登录",onClick:j}]};return e.jsxs(S,{style:{minHeight:"100vh"},children:[e.jsxs(re,{trigger:null,collapsible:!0,collapsed:c,children:[e.jsx("div",{className:c?"demo-logo-vertical is-collapsed":"demo-logo-vertical",children:e.jsx("h4",{children:" React-Admin"})}),e.jsx(T,{mode:"inline",defaultSelectedKeys:["/"],selectedKeys:[a],items:[{key:"/",icon:e.jsx(U,{}),label:e.jsx(L,{to:"/",children:"首页"})},{key:"/items",icon:e.jsx(b,{}),label:e.jsx(L,{to:"/items",children:"列表"})}]})]}),e.jsxs(S,{children:[e.jsxs(oe,{style:{background:"#fff",padding:"0 24px 0 0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(d,{type:"text",icon:c?e.jsx(J,{}):e.jsx(Q,{}),onClick:()=>p(!c),style:{fontSize:"16px",width:64,height:64}}),e.jsx(M,{menu:y,placement:"bottomRight",children:e.jsxs($,{className:"user-info",style:{cursor:"pointer"},children:[i?e.jsx(k,{src:se,alt:"avatar",crossOrigin:"anonymous"}):e.jsx(k,{icon:e.jsx(b,{})}),e.jsx("span",{children:(o==null?void 0:o.username)||"未登录"})]})})]}),e.jsx(ne,{style:{margin:"16px"},children:t})]})]})},ae=()=>e.jsxs("div",{children:[e.jsx("h1",{children:"欢迎来到首页"}),e.jsx("p",{children:"This is the home page of the admin system."})]}),le=({data:t,onEdit:n,onDelete:o})=>{const i=[{title:"编号",dataIndex:"id",key:"id"},{title:"名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"description",key:"description"},{title:"操作",key:"action",render:(r,s)=>e.jsxs(e.Fragment,{children:[e.jsx(d,{onClick:()=>n(s),children:"编辑"}),e.jsx(d,{onClick:()=>o(s.id),danger:!0,children:"删除"})]})}];return e.jsx(B,{dataSource:t,columns:i,rowKey:"id"})},ce=({initialValues:t,onSubmit:n,onCancel:o})=>{const{register:i,handleSubmit:r,formState:{errors:s},setValue:a}=V({defaultValues:t});g.useEffect(()=>{t&&(a("id",t.id),a("name",t.name),a("description",t.description))},[t,a]);const c=p=>{console.log(p),n(p)};return e.jsxs(m,{onFinish:r(c),children:[e.jsxs(m.Item,{label:"名称",...i("name",{required:"名称为必填项"}),children:[e.jsx(x,{}),s.name&&e.jsx("span",{style:{color:"red"},children:s.name.message})]}),e.jsx(m.Item,{label:"描述",...i("description"),children:e.jsx(x.TextArea,{})}),e.jsxs(m.Item,{children:[e.jsx(d,{type:"primary",htmlType:"submit",children:"提交"}),e.jsx(d,{onClick:o,style:{marginLeft:8},children:"取消"})]})]})},me=[{id:1,name:"Item 1",description:"Description 1"},{id:2,name:"Item 2",description:"Description 2"},{id:3,name:"Item 3",description:"Description 3"}],de=()=>{const[t,n]=h.useState(me),[o,i]=h.useState(null),[r,s]=h.useState(!1),a=l=>{i(l),s(!0)},c=l=>{n(t.filter(u=>u.id!==l))},p=l=>{if(o)n(t.map(u=>u.id===l.id?l:u));else{const u={...l,id:Date.now()};n([...t,u])}s(!1),i(null)},j=()=>{s(!1),i(null)},y=()=>{i(null),s(!0)};return e.jsxs("div",{className:"App",children:[e.jsx("h1",{children:"用户列表"}),e.jsx(d,{onClick:y,type:"primary",style:{marginBottom:16},children:"新增"}),r&&e.jsx(ce,{initialValues:o||void 0,onSubmit:p,onCancel:j}),e.jsx(le,{data:t,onEdit:a,onDelete:c})]})},pe=()=>{const t=D(),[n,o]=h.useState(!1),i=v(),r=async s=>{try{o(!0),await new Promise(a=>setTimeout(a,1e3)),s.username==="admin"&&s.password==="123456"?(f.success("登录成功！"),localStorage.setItem("token","dummy-token"),localStorage.setItem("userInfo",JSON.stringify({username:s.username})),t(X("dummy-token")),t(Y({username:s.username})),i("/",{replace:!0})):f.error("用户名或密码错误！")}catch(a){console.log(a),f.error("登录失败，请重试！")}finally{o(!1)}};return e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsx("h1",{children:"系统登录"}),e.jsxs(m,{name:"loginForm",onFinish:r,autoComplete:"off",children:[e.jsx(m.Item,{name:"username",rules:[{required:!0,message:"请输入用户名！"}],children:e.jsx(x,{prefix:e.jsx(b,{}),placeholder:"请输入用户名",size:"large"})}),e.jsx(m.Item,{name:"password",rules:[{required:!0,message:"请输入密码！"}],children:e.jsx(x.Password,{prefix:e.jsx(G,{}),placeholder:"请输入密码",size:"large"})}),e.jsx(m.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",loading:n,block:!0,size:"large",children:"登录"})})]})]})})},R=[{path:"/",element:g.createElement(ae)},{path:"/items",element:g.createElement(de)},{path:"/login",element:g.createElement(pe)}],ue=()=>{var n;const{isLoggedIn:t}=N(o=>o.user);return e.jsxs(z,{children:[e.jsx(I,{path:"/login",element:(n=R.find(o=>o.path==="/login"))==null?void 0:n.element}),t?R.filter(o=>o.path!=="/login").map((o,i)=>e.jsx(I,{path:o.path,element:e.jsx(ie,{children:o.element})},i)):e.jsx(I,{path:"*",element:e.jsx(K,{to:"/login",replace:!0})})]})},he=()=>e.jsx(E,{store:te,children:e.jsx(q,{children:e.jsx(ue,{})})}),ge=F.createRoot(document.getElementById("root"));ge.render(e.jsx(g.StrictMode,{children:e.jsx(he,{})}));
