import{h as B,i as $,a as L,_ as j,e as I,d as A,g as F}from"./@babel-CbNk-B6_.js";import{r as n}from"./react-CIM1rrag.js";import{s as J,i as K,e as T,J as C,y as V}from"./rc-util-jI2IUycA.js";import{i as X}from"./resize-observer-polyfill-B1PUzC5B.js";var b=n.createContext(null);function Y(e){var i=e.children,r=e.onBatchResize,a=n.useRef(0),t=n.useRef([]),o=n.useContext(b),d=n.useCallback(function(v,f,s){a.current+=1;var h=a.current;t.current.push({size:v,element:f,data:s}),Promise.resolve().then(function(){h===a.current&&(r==null||r(t.current),t.current=[])}),o==null||o(v,f,s)},[r,o]);return n.createElement(b.Provider,{value:d},i)}var c=new Map;function q(e){e.forEach(function(i){var r,a=i.target;(r=c.get(a))===null||r===void 0||r.forEach(function(t){return t(a)})})}var M=new X(q);function G(e,i){c.has(e)||(c.set(e,new Set),M.observe(e)),c.get(e).add(i)}function Q(e,i){c.has(e)&&(c.get(e).delete(i),c.get(e).size||(M.unobserve(e),c.delete(e)))}var U=function(e){B(r,e);var i=$(r);function r(){return L(this,r),i.apply(this,arguments)}return j(r,[{key:"render",value:function(){return this.props.children}}]),r}(n.Component);function Z(e,i){var r=e.children,a=e.disabled,t=n.useRef(null),o=n.useRef(null),d=n.useContext(b),v=typeof r=="function",f=v?r(t):r,s=n.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),h=!v&&n.isValidElement(f)&&J(f),O=h?K(f):null,D=T(O,t),z=function(){var l;return C(t.current)||(t.current&&A(t.current)==="object"?C((l=t.current)===null||l===void 0?void 0:l.nativeElement):null)||C(o.current)};n.useImperativeHandle(i,function(){return z()});var E=n.useRef(e);E.current=e;var _=n.useCallback(function(u){var l=E.current,w=l.onResize,N=l.data,y=u.getBoundingClientRect(),p=y.width,m=y.height,R=u.offsetWidth,g=u.offsetHeight,x=Math.floor(p),W=Math.floor(m);if(s.current.width!==x||s.current.height!==W||s.current.offsetWidth!==R||s.current.offsetHeight!==g){var k={width:x,height:W,offsetWidth:R,offsetHeight:g};s.current=k;var P=R===Math.round(p)?p:R,S=g===Math.round(m)?m:g,H=I(I({},k),{},{offsetWidth:P,offsetHeight:S});d==null||d(H,u,N),w&&Promise.resolve().then(function(){w(H,u)})}},[]);return n.useEffect(function(){var u=z();return u&&!a&&G(u,_),function(){return Q(u,_)}},[t.current,a]),n.createElement(U,{ref:o},h?n.cloneElement(f,{ref:D}):f)}var ee=n.forwardRef(Z),re="rc-observer-key";function ne(e,i){var r=e.children,a=typeof r=="function"?[r]:V(r);return a.map(function(t,o){var d=(t==null?void 0:t.key)||"".concat(re,"-").concat(o);return n.createElement(ee,F({},e,{key:d,ref:o===0?i:void 0}),t)})}var te=n.forwardRef(ne);te.Collection=Y;export{te as R};
