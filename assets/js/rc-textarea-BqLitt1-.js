import{k as Re,c as T,d as Le,e as I,g as be,b as me,f as _e}from"./@babel-CbNk-B6_.js";import{c as K}from"./classnames-ELZfJkp_.js";import{u as Be,B as Oe,r as he}from"./rc-input-RdaaKTYE.js";import{A as ze,u as Se,t as xe}from"./rc-util-jI2IUycA.js";import{r as d,a as x}from"./react-CIM1rrag.js";import{R as De}from"./rc-resize-observer-DzFB8mcR.js";var He=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,Ke=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],se={},g;function Ye(e){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(w&&se[n])return se[n];var r=window.getComputedStyle(e),R=r.getPropertyValue("box-sizing")||r.getPropertyValue("-moz-box-sizing")||r.getPropertyValue("-webkit-box-sizing"),c=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),o=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),i=Ke.map(function(u){return"".concat(u,":").concat(r.getPropertyValue(u))}).join(";"),b={sizingStyle:i,paddingSize:c,borderSize:o,boxSizing:R};return w&&n&&(se[n]=b),b}function je(e){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;g||(g=document.createElement("textarea"),g.setAttribute("tab-index","-1"),g.setAttribute("aria-hidden","true"),g.setAttribute("name","hiddenTextarea"),document.body.appendChild(g)),e.getAttribute("wrap")?g.setAttribute("wrap",e.getAttribute("wrap")):g.removeAttribute("wrap");var R=Ye(e,w),c=R.paddingSize,o=R.borderSize,i=R.boxSizing,b=R.sizingStyle;g.setAttribute("style","".concat(b,";").concat(He)),g.value=e.value||e.placeholder||"";var u=void 0,l=void 0,z,v=g.scrollHeight;if(i==="border-box"?v+=o:i==="content-box"&&(v-=c),n!==null||r!==null){g.value=" ";var F=g.scrollHeight-c;n!==null&&(u=F*n,i==="border-box"&&(u=u+c+o),v=Math.max(u,v)),r!==null&&(l=F*r,i==="border-box"&&(l=l+c+o),z=v>l?"":"hidden",v=Math.min(l,v))}var f={height:v,overflowY:z,resize:"none"};return u&&(f.minHeight=u),l&&(f.maxHeight=l),f}var ke=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],de=0,ce=1,fe=2,We=d.forwardRef(function(e,w){var n=e,r=n.prefixCls,R=n.defaultValue,c=n.value,o=n.autoSize,i=n.onResize,b=n.className,u=n.style,l=n.disabled,z=n.onChange;n.onInternalAutoSize;var v=Re(n,ke),F=ze(R,{value:c,postState:function(s){return s??""}}),f=T(F,2),L=f[0],q=f[1],J=function(s){q(s.target.value),z==null||z(s)},p=d.useRef();d.useImperativeHandle(w,function(){return{textArea:p.current}});var $=d.useMemo(function(){return o&&Le(o)==="object"?[o.minRows,o.maxRows]:[]},[o]),Y=T($,2),m=Y[0],y=Y[1],N=!!o,Q=function(){try{if(document.activeElement===p.current){var s=p.current,X=s.selectionStart,ne=s.selectionEnd,ae=s.scrollTop;p.current.setSelectionRange(X,ne),p.current.scrollTop=ae}}catch{}},j=d.useState(fe),_=T(j,2),C=_[0],V=_[1],ee=d.useState(),k=T(ee,2),W=k[0],B=k[1],O=function(){V(de)};Se(function(){N&&O()},[c,m,y,N]),Se(function(){if(C===de)V(ce);else if(C===ce){var h=je(p.current,!1,m,y);V(fe),B(h)}else Q()},[C]);var M=d.useRef(),Z=function(){xe.cancel(M.current)},G=function(s){C===fe&&(i==null||i(s),o&&(Z(),M.current=xe(function(){O()})))};d.useEffect(function(){return Z},[]);var te=N?W:null,P=I(I({},u),te);return(C===de||C===ce)&&(P.overflowY="hidden",P.overflowX="hidden"),d.createElement(De,{onResize:G,disabled:!(o||i)},d.createElement("textarea",be({},v,{ref:p,style:P,className:K(r,b,me({},"".concat(r,"-disabled"),l)),disabled:l,value:L,onChange:J})))}),Ze=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],et=x.forwardRef(function(e,w){var n,r=e.defaultValue,R=e.value,c=e.onFocus,o=e.onBlur,i=e.onChange,b=e.allowClear,u=e.maxLength,l=e.onCompositionStart,z=e.onCompositionEnd,v=e.suffix,F=e.prefixCls,f=F===void 0?"rc-textarea":F,L=e.showCount,q=e.count,J=e.className,p=e.style,$=e.disabled,Y=e.hidden,m=e.classNames,y=e.styles,N=e.onResize,Q=e.onClear,j=e.onPressEnter,_=e.readOnly,C=e.autoSize,V=e.onKeyDown,ee=Re(e,Ze),k=ze(r,{value:R,defaultValue:r}),W=T(k,2),B=W[0],O=W[1],M=B==null?"":String(B),Z=x.useState(!1),G=T(Z,2),te=G[0],P=G[1],h=x.useRef(!1),s=x.useState(null),X=T(s,2),ne=X[0],ae=X[1],re=d.useRef(null),oe=d.useRef(null),E=function(){var t;return(t=oe.current)===null||t===void 0?void 0:t.textArea},ge=function(){E().focus()};d.useImperativeHandle(w,function(){var a;return{resizableTextArea:oe.current,focus:ge,blur:function(){E().blur()},nativeElement:((a=re.current)===null||a===void 0?void 0:a.nativeElement)||E()}}),d.useEffect(function(){P(function(a){return!$&&a})},[$]);var ye=x.useState(null),ve=T(ye,2),ie=ve[0],Ce=ve[1];x.useEffect(function(){if(ie){var a;(a=E()).setSelectionRange.apply(a,_e(ie))}},[ie]);var S=Be(q,L),D=(n=S.max)!==null&&n!==void 0?n:u,we=Number(D)>0,ue=S.strategy(M),Ee=!!D&&ue>D,pe=function(t,A){var U=A;!h.current&&S.exceedFormatter&&S.max&&S.strategy(A)>S.max&&(U=S.exceedFormatter(A,{max:S.max}),A!==U&&Ce([E().selectionStart||0,E().selectionEnd||0])),O(U),he(t.currentTarget,t,i,U)},Ae=function(t){h.current=!0,l==null||l(t)},Ie=function(t){h.current=!1,pe(t,t.currentTarget.value),z==null||z(t)},Te=function(t){pe(t,t.target.value)},Fe=function(t){t.key==="Enter"&&j&&j(t),V==null||V(t)},Ne=function(t){P(!0),c==null||c(t)},Ve=function(t){P(!1),o==null||o(t)},Pe=function(t){O(""),ge(),he(E(),t,i)},le=v,H;S.show&&(S.showFormatter?H=S.showFormatter({value:M,count:ue,maxLength:D}):H="".concat(ue).concat(we?" / ".concat(D):""),le=x.createElement(x.Fragment,null,le,x.createElement("span",{className:K("".concat(f,"-data-count"),m==null?void 0:m.count),style:y==null?void 0:y.count},H)));var $e=function(t){var A;N==null||N(t),(A=E())!==null&&A!==void 0&&A.style.height&&ae(!0)},Me=!C&&!L&&!b;return x.createElement(Oe,{ref:re,value:M,allowClear:b,handleReset:Pe,suffix:le,prefixCls:f,classNames:I(I({},m),{},{affixWrapper:K(m==null?void 0:m.affixWrapper,me(me({},"".concat(f,"-show-count"),L),"".concat(f,"-textarea-allow-clear"),b))}),disabled:$,focused:te,className:K(J,Ee&&"".concat(f,"-out-of-range")),style:I(I({},p),ne&&!Me?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof H=="string"?H:void 0}},hidden:Y,readOnly:_,onClear:Q},x.createElement(We,be({},ee,{autoSize:C,maxLength:u,onKeyDown:Fe,onChange:Te,onFocus:Ne,onBlur:Ve,onCompositionStart:Ae,onCompositionEnd:Ie,className:K(m==null?void 0:m.textarea),style:I(I({},y==null?void 0:y.textarea),{},{resize:p==null?void 0:p.resize}),disabled:$,prefixCls:f,onResize:$e,ref:oe,readOnly:_})))});export{et as T};
